tinymce.PluginManager.add('ketcher', function (editor, url) {
  editor.ui.registry.addButton('ketcher23', {
    tooltip: 'Ketcher Insert chemical structure',
    icon: 'chemical',
    onAction: function () {
      top.dispatchEvent(new CustomEvent("OPEN_KETCHER_DIALOG"));
    }
  });

  editor.addCommand("cmdKetcherEditable", function () {
    top.dispatchEvent(new CustomEvent("OPEN_KETCHER_DIALOG"));
  });

  editor.ui.registry.addMenuItem('ketcherMenuItem', {
		text: 'Ketcher Insert chemical structure',
		tooltip: 'Ketcher Insert chemical structure',
		icon: 'chemical',
		onAction: function () {
			editor.execCommand("cmdKetcherEditable");
		}
	});

  if(!window.insertActions) window.insertActions = new Map();
  
  window.insertActions.set("ketcherMenuItem", {
    text: 'Ketcher Insert chemical structure',
    icon: 'chemical',
    action: () => {
      editor.execCommand("cmdKetcherEditable");
    },
  });

  editor.addCommand("cmdKetcherViewable", function () {
    top.dispatchEvent(new CustomEvent("OPEN_KETCHER_VIEWER"));
  });


});